
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Monitor Your Web Site with check_http &#8212; NEMS Linux Documentation 1.6 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Monitor A Non-Standard Port with check_tcp" href="check_tcp.html" />
    <link rel="prev" title="Beginner Exercises" href="../exercises.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="monitor-your-web-site-with-check-http">
<h1>Monitor Your Web Site with check_http<a class="headerlink" href="#monitor-your-web-site-with-check-http" title="Permalink to this headline">¶</a></h1>
<div class="section" id="exercise-introduction">
<h2>Exercise Introduction<a class="headerlink" href="#exercise-introduction" title="Permalink to this headline">¶</a></h2>
<p>Your web site is the face of your business. If it ever goes down for any reason, or becomes sluggish, it’s important to be proactive in remedying the situation. What’s worse than having a customer contact you to let you know your web site is down? Realizing it might have been down for a week and the customers during that time didn’t let you know: They just went elsewhere.</p>
<p>Having your web site become sluggish or unresponsive can also damage your organic SEO standings.</p>
<p>In this exercise, we’ll learn how to setup NEMS Linux to notify you if your web site fails to respond for more than 10 minutes. With this skill, you will be able to proactively monitor your own, your customers’ or any http/https web site for uptime or slow response time.</p>
<p>If your site goes offline, or becomes unresponsive or sluggish, NEMS Linux can send you an alert by a number of methods including email, Telegram or Pushover. This capability makes NEMS Linux a fantastic tool for web designers and hosts who want to ensure their customer sites are always up so the customer doesn’t notice any downtime. If your site is hosted over SSL, NEMS can even notify you if your certificate has expired – or is about to expire. There are so many options since NEMS Linux has been built to <em>monitor everything</em>.</p>
<p>For this exercise, we’ll use the built-in <em>check_http</em> command. For my example, I’ll use <code class="docutils literal"><span class="pre">https://nemslinux.com/</span></code> – I would suggest you do the same for the sake of the lesson, and then try changing the Host to your own domain once you understand how everything is connected.</p>
<p>It may appear onerous as you glance over the following steps, but keep in mind once you create your config, you can reuse it for as many web site hosts as you like by simply assigning your host to the <em>web_site_ssl</em> host group, which you’ll learn to create below.</p>
<p>Configuration is done in NEMS Configurator (NConf). Open that tool via the Configuration menu on NEMS Dashboard.</p>
</div>
<div class="section" id="steps">
<h2>Steps<a class="headerlink" href="#steps" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>The <em>check-host-alive</em> command, found in <em>misccommands</em> in NConf, is used to check hosts to determine if they are up or down. My web site, nemslinux.com, will only respond on IPv4. However, the default <em>check-host-alive</em> command will attempt to use IPv6. Rather than editing the sample command, let’s add a new one based upon it, but this one will only use IPv4. That way, we can still use the old command when we need IPv6 for a different host.</li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li>Show the misccommands list.</li>
<li>Edit <em>check-host-alive</em></li>
<li>Highlight and copy the entire command line to your clipboard.</li>
<li>Click Add next to misccommands to add a new command.</li>
<li>Name your new command <cite>check-host-alive-ipv4</cite></li>
<li>Paste the command line from your clipboard.</li>
<li>At the very end of the command line, simply add a space, followed by -4 to tell it to use IPv4 for this check.</li>
<li>Save the new command.</li>
</ol>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="../../_images/Create-New-misccommand-to-check-host-alive-Using-IPv4.png"><img alt="Create IPv4 Check Command" src="../../_images/Create-New-misccommand-to-check-host-alive-Using-IPv4.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">Create New misccommand to check-host-alive Using IPv4</span></p>
</div>
</div></blockquote>
<ol class="arabic simple" start="2">
<li>Our commands are ready for us, so now it’s time to setup our Host Preset. We want to create one for IPv4 Web Sites. That way, we can reuse the preset for every IPv4-based web site we want to monitor with NEMS Linux.</li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li>Add a new host preset.</li>
<li>Name your preset Web Site IPv4</li>
<li>Set the host alive check to the new command you created in Step 2: <em>check-host-alive-ipv4</em></li>
<li>Save your host preset.</li>
</ol>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="../../_images/New-Host-Preset-for-IPv4-Web-Sites.png"><img alt="Create IPv4 Host Preset" src="../../_images/New-Host-Preset-for-IPv4-Web-Sites.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">New Host Preset for IPv4 Web Sites</span></p>
</div>
</div></blockquote>
<ol class="arabic simple" start="3">
<li>So far, everything we’ve done can be reused for any web site whose hostname resolves to an IPv4 address. From here forward however, we’ll be setting up our host group specifically for a secure (SSL) web site.</li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li>Add a new hostgroup.</li>
<li>Call this web_site_ssl</li>
<li>Leave everything else as is and save your new hostgroup.</li>
</ol>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="../../_images/New-hostgroup-for-web_site_ssl.png"><img alt="Create SSL Host" src="../../_images/New-hostgroup-for-web_site_ssl.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">New hostgroup for web_site_ssl</span></p>
</div>
</div></blockquote>
<ol class="arabic simple" start="4">
<li>Why would we create a new hostgroup if it has no settings beyond a name? Well, this is where the magic happens. We now have a check command, a check host alive command, a host preset and a hostgroup. Now, we can link them all together, starting with an Advanced Service. Remember, the idea here is that everything we do can be assigned to as many hosts as we like. No having to redo all this for the next web site.</li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li>Click Add next to Advanced Services.</li>
<li>Name your service: <em>Web Site (SSL)</em></li>
<li>Give it an alias: <em>Uptime of SSL Web Site</em></li>
<li>Set the check period and notification period to 24x7</li>
<li>In <em>assign advanced-service to hostgroup</em>, highlight the hostgroup we created (web_site_ssl) and press the green arrow to add it to the selected items list.</li>
<li>Under <em>contact groups</em> be sure to add <em>admins</em> as well. Otherwise, you won’t receive notifications.</li>
<li>Set your notifications as follows:</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>max check attempts: 10</li>
<li>check interval: 1</li>
<li>retry interval: 5</li>
<li>first notification delay: 10</li>
<li>notification interval: 30</li>
<li>notification options: w,u,c,r,f</li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="8">
<li>Finally, set your service parameters to: <cite>-S --sni</cite></li>
<li>Save your advanced service.</li>
</ol>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The -S tells check_http that this site is using SSL, and the --sni enables SNI (Server Name Indication) since I use CloudFlare for SSL on nemslinux.com, and therefore my resolving IP address is associated with more than one domain name. For your site, if you have any trouble, try removing SNI by simply omitting --sni. For the full documentation surrounding the check_http command, visit <a class="reference external" href="../../check_commands/check_http.html">the check_http documentation</a>.</p>
</div>
</div></blockquote>
<p>.</p>
<blockquote>
<div><div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="../../_images/Creating-an-Advanced-Service-to-Check-SSL-Web-Sites.png"><img alt="Create SSL Advanced Service" src="../../_images/Creating-an-Advanced-Service-to-Check-SSL-Web-Sites.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">Creating an Advanced Service to Check SSL Web Sites</span></p>
</div>
</div></blockquote>
<ol class="arabic simple" start="5">
<li>Finally, let’s add our web site host. From now on, this is the only step you have to take to add more sites to your NEMS Linux server.</li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li>Add a new host.</li>
<li>Set the following:</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>hostname: <code class="docutils literal"><span class="pre">https://nemslinux.com</span></code></li>
<li>alias: <em>NEMS Web Site</em></li>
<li>address: <em>nemslinux.com</em></li>
<li>OS: <em>Linux</em></li>
<li>host preset: <em>Web Site IPv4</em> (See what we did there?)</li>
<li>monitored by: <em>Default Nagios</em></li>
<li>host is collector: <em>no</em></li>
<li>check period: <em>24x7</em></li>
<li>notification period: <em>24x7</em></li>
<li>max check attempts: <em>10</em></li>
<li>check interval: <em>1</em></li>
<li>retry interval: <em>5</em></li>
<li>first notification delay: <em>10</em></li>
<li>notification interval: <em>30</em></li>
<li>notification options: <em>d,u,r,f</em></li>
<li>assign host to hostgroup (are you ready for this?): <em>web_site_ssl</em></li>
</ul>
</div></blockquote>
<div class="figure align-center" id="id5">
<a class="reference internal image-reference" href="../../_images/Creating-a-Host-to-Monitor-IPv4-SSL-Web-Site.png"><img alt="Create Host for IPv4 SSL web site" src="../../_images/Creating-a-Host-to-Monitor-IPv4-SSL-Web-Site.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">Creating a Host to Monitor IPv4 SSL Web Site</span></p>
</div>
<ol class="arabic simple" start="3">
<li>Save the host.</li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="6">
<li>Generate your config.</li>
</ol>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>If you followed the steps correctly and my web site is up, Adagios should report all is well.</p>
<div class="figure align-center" id="id6">
<a class="reference internal image-reference" href="../../_images/NEMS-Adagios-Shows-nemslinux.com-is-UP.png"><img alt="nemslinux.com is UP" src="../../_images/NEMS-Adagios-Shows-nemslinux.com-is-UP.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">NEMS Adagios Shows nemslinux.com is UP</span></p>
</div>
<p>To test what would happen if it were to start failing, change the hostname in the Host to nemslinux.com1 (which obviously will not respond), and then generate your config again.</p>
<p>Once you feel ready, change the Host to your own web site. If your site is SSL, you should only need to change the hostname, alias and address of the host. If it’s not SSL, repeat Step 3 above, but this time create a new hostgroup called web_site_no_ssl, and then repeat Step 4, but creating a new Advanced Service called Web Site (Non-SSL), assign it (4.5) to Web Site (Non-SSL) and leave off the SSL parameters in 4.8.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Monitor Your Web Site with check_http</a><ul>
<li><a class="reference internal" href="#exercise-introduction">Exercise Introduction</a></li>
<li><a class="reference internal" href="#steps">Steps</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">NEMS Linux Getting Started Guide</a><ul>
  <li><a href="../exercises.html">Beginner Exercises</a><ul>
      <li>Previous: <a href="../exercises.html" title="previous chapter">Beginner Exercises</a></li>
      <li>Next: <a href="check_tcp.html" title="next chapter">Monitor A Non-Standard Port with check_tcp</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/gettingstarted/exercises/check_http.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Category5 TV Network.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.7</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="../../_sources/gettingstarted/exercises/check_http.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>